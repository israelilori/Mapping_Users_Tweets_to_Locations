---
title: "Import_keyworddata"
  html_document: default
  pdf_document: default
---

#  Extracting data from Twitter using Keyword search
This section describes how tweets were extracted using keywork search. The objective of the search and extraction was to extract tweets which mentioned the candidates which where included in our analysis. Especially the keyword search data was relevant to perform the Sentiment Polarity analysis and create the Emotion Detection Analysis. The list below describe the keywords used to extract the desired Tweets.

Keywords used for the different candidates:
- "Kamala Harris+KamalaHarris" 
- "Elizabeth Warren+eWarren"
- "Bernie Sanders+BernieSanders" 
- "Julian Castro+JulianCastro" 
- "Ocasio-Cortez+AOC" 
- "Donald Trump+realDonaldTrump" 

## Connecting to the Twitter API
This section connects to the Twitter API.

```{r setup, include=FALSE}

# install necessary packages
install.packages("rTweet")
install.packages("ROAuth")
library(ROAuth)
library(rtweet)

# authenticate with Twitter
consumerKey<-	"mn4r7OWTnHd61HsBoTzlNJ9lV"
consumerSecret<-"1hu5WF9inRQcDOckO53BxnCoCrU1xJCK6CigfOQZ5tXBvPIsFp"

accessToken<-"1100396770222313472-U6kj1Vw2vKDFQvJtAsnejNhcTp5jcw"
accessSecret<-"SStMgfyZQcYJLTZ1Ym30GesHwyFFsD6EJpRal3U75DwRs"

setup_twitter_oauth (consumerKey, consumerSecret, accessToken, accessSecret)  # authenticate

```

## Using rTweet package to get entire tweets (not truncated)
This section shows how the keyword data was extracted and the parameters used. For each candidate the routines below where run, resulting in the following csv-files:
- Trump_keyword.csv
- Sanders_keyword.csv
- Ocasio_Cortez_keyword.csv
- Harris_keyword.csv
- Warren_Keyword.csv
- Castro_keyword.csv
All these files are attached in the material handed in.

Notice: The date of scraping the keyword data: 06/03/2019  

```{r setup, include=FALSE}
library(rtweet)

#using rtweet library to get tweets by keyword with the entire text
l <- search_tweets("Donald Trump+realDonaldTrump", n = 10000, type = "mixed", max_id = NULL, parse = TRUE, token = NULL, verbose = TRUE)

#convert to dataframe
df2 <- as.data.frame(l)

#keep only columns we are gonna use in the analysis
keeps <- c("user_id","created_at", "screen_name", "text", "is_retweet", "lang")
df2 <- subset(df2, select = keeps)

#count number and percentage of retweets extracted
count_retweets = sum(df2["is_retweet"] == TRUE)
portion_retweets = count_retweets/nrow(df2["is_retweet"] )
portion_retweets

# convert to be able to write to csv
df2 <- apply(df2,2,as.character) 

# write out to a CSV file
write.csv(df2, file="Trump_keyword.csv")

```


